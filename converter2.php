<?php


$source = '{
  "indicator": {
    "-id": "ind12",
    "-name": "Среднемесячная заработная плата на средних и крупных предприятиях",
    "dates": {
      "date": [
        "I кв 2011",
        "II кв 2011",
        "III кв 2011",
        "IV кв 2011",
        "I кв 2012",
        "II кв 2012",
        "III кв 2012",
        "IV кв 2012",
        "I кв 2013"
      ]
    },
    "turkmenistandata": {
      "values": {
        "v": [
          "111.2",
          "114.5",
          "115.7",
          "118.1",
          "111.2",
          "114.5",
          "115.7",
          "118.1",
          "118.1"
        ]
      }
    },
    "velaiatdata": {
      "legend": {
        "interval": [
          {
            "-minVal": "100",
            "-maxVal": "112",
            "-color": "#026CA3"
          },
          {
            "-minVal": "112",
            "-maxVal": "114",
            "-color": "#5DBF86"
          },
          {
            "-minVal": "114",
            "-maxVal": "116",
            "-color": "#ADD136"
          },
          {
            "-minVal": "116",
            "-maxVal": "118",
            "-color": "#FAEE3A"
          },
          {
            "-minVal": "118",
            "-maxVal": "120",
            "-color": "#F5AD15"
          },
          {
            "-minVal": "120",
            "-maxVal": "200",
            "-color": "#D1A14E"
          }
        ]
      },
      "values": {
        "region": [
          {
            "-id": "av",
            "v": [
              "111.2",
              "114.5",
              "115.7",
              "118.1",
              "111.2",
              "114.5",
              "115.7",
              "118.1",
              "118.1"
            ]
          },
          {
            "-id": "ash",
            "v": [
              "113.8",
              "115.4",
              "116.4",
              "119.1",
              "113.8",
              "115.4",
              "116.4",
              "119.1",
              "119.1"
            ]
          },
          {
            "-id": "bv",
            "v": [
              "114.6",
              "114.6",
              "115.8",
              "118.2",
              "114.6",
              "114.6",
              "115.8",
              "118.2",
              "118.2"
            ]
          },
          {
            "-id": "lv",
            "v": [
              "111.4",
              "114.3",
              "115.9",
              "117.7",
              "111.4",
              "114.3",
              "115.9",
              "117.7",
              "117.7"
            ]
          },
          {
            "-id": "dv",
            "v": [
              "110.9",
              "114.4",
              "116",
              "117.6",
              "110.9",
              "114.4",
              "116",
              "117.6",
              "117.6"
            ]
          },
          {
            "-id": "mv",
            "v": [
              "111.5",
              "114.3",
              "116.1",
              "118",
              "111.5",
              "114.3",
              "116.1",
              "118",
              "118"
            ]
          }
        ]
      }
    },
    "etrapdata": {
      "legend": {
        "interval": [
          {
            "-minVal": "100",
            "-maxVal": "112",
            "-color": "#026CA3"
          },
          {
            "-minVal": "112",
            "-maxVal": "114",
            "-color": "#5DBF86"
          },
          {
            "-minVal": "114",
            "-maxVal": "116",
            "-color": "#ADD136"
          },
          {
            "-minVal": "116",
            "-maxVal": "118",
            "-color": "#FAEE3A"
          },
          {
            "-minVal": "118",
            "-maxVal": "120",
            "-color": "#F5AD15"
          },
          {
            "-minVal": "120",
            "-maxVal": "200",
            "-color": "#D1A14E"
          }
        ]
      },
      "values": {
        "region": [
          {
            "-id": "001",
            "v": [
              "111.2",
              "114.5",
              "115.7",
              "118.1",
              "111.2",
              "114.5",
              "115.7",
              "118.1",
              "118.1"
            ]
          },
          {
            "-id": "002",
            "v": [
              "113.8",
              "115.4",
              "116.4",
              "119.1",
              "113.8",
              "115.4",
              "116.4",
              "119.1",
              "119.1"
            ]
          },
          {
            "-id": "003",
            "v": [
              "114.6",
              "114.6",
              "115.8",
              "118.2",
              "114.6",
              "114.6",
              "115.8",
              "118.2",
              "118.2"
            ]
          },
          {
            "-id": "004",
            "v": [
              "111.4",
              "114.3",
              "115.9",
              "117.7",
              "111.4",
              "114.3",
              "115.9",
              "117.7",
              "117.7"
            ]
          },
          {
            "-id": "005",
            "v": [
              "110.9",
              "114.4",
              "116",
              "117.6",
              "110.9",
              "114.4",
              "116",
              "117.6",
              "117.6"
            ]
          },
          {
            "-id": "006",
            "v": [
              "111.5",
              "114.3",
              "116.1",
              "118",
              "111.5",
              "114.3",
              "116.1",
              "118",
              "118"
            ]
          },
          {
            "-id": "007",
            "v": [
              "111.2",
              "114.5",
              "115.7",
              "118.1",
              "111.2",
              "114.5",
              "115.7",
              "118.1",
              "118.1"
            ]
          },
          {
            "-id": "008",
            "v": [
              "113.8",
              "115.4",
              "116.4",
              "119.1",
              "113.8",
              "115.4",
              "116.4",
              "119.1",
              "119.1"
            ]
          },
          {
            "-id": "009",
            "v": [
              "114.6",
              "114.6",
              "115.8",
              "118.2",
              "114.6",
              "114.6",
              "115.8",
              "118.2",
              "118.2"
            ]
          },
          {
            "-id": "010",
            "v": [
              "111.4",
              "114.3",
              "115.9",
              "117.7",
              "111.4",
              "114.3",
              "115.9",
              "117.7",
              "117.7"
            ]
          },
          {
            "-id": "011",
            "v": [
              "110.9",
              "114.4",
              "116",
              "117.6",
              "110.9",
              "114.4",
              "116",
              "117.6",
              "117.6"
            ]
          },
          {
            "-id": "012",
            "v": [
              "111.5",
              "114.3",
              "116.1",
              "118",
              "111.5",
              "114.3",
              "116.1",
              "118",
              "118"
            ]
          },
          {
            "-id": "013",
            "v": [
              "111.2",
              "114.5",
              "115.7",
              "118.1",
              "111.2",
              "114.5",
              "115.7",
              "118.1",
              "118.1"
            ]
          },
          {
            "-id": "014",
            "v": [
              "113.8",
              "115.4",
              "116.4",
              "119.1",
              "113.8",
              "115.4",
              "116.4",
              "119.1",
              "119.1"
            ]
          },
          {
            "-id": "015",
            "v": [
              "114.6",
              "114.6",
              "115.8",
              "118.2",
              "114.6",
              "114.6",
              "115.8",
              "118.2",
              "118.2"
            ]
          },
          {
            "-id": "016",
            "v": [
              "111.4",
              "114.3",
              "115.9",
              "117.7",
              "111.4",
              "114.3",
              "115.9",
              "117.7",
              "117.7"
            ]
          },
          {
            "-id": "017",
            "v": [
              "110.9",
              "114.4",
              "116",
              "117.6",
              "110.9",
              "114.4",
              "116",
              "117.6",
              "117.6"
            ]
          },
          {
            "-id": "018",
            "v": [
              "111.5",
              "114.3",
              "116.1",
              "118",
              "111.5",
              "114.3",
              "116.1",
              "118",
              "118"
            ]
          },
          {
            "-id": "019",
            "v": [
              "111.2",
              "114.5",
              "115.7",
              "118.1",
              "111.2",
              "114.5",
              "115.7",
              "118.1",
              "118.1"
            ]
          },
          {
            "-id": "020",
            "v": [
              "113.8",
              "115.4",
              "116.4",
              "119.1",
              "113.8",
              "115.4",
              "116.4",
              "119.1",
              "119.1"
            ]
          },
          {
            "-id": "021",
            "v": [
              "114.6",
              "114.6",
              "115.8",
              "118.2",
              "114.6",
              "114.6",
              "115.8",
              "118.2",
              "118.2"
            ]
          },
          {
            "-id": "022",
            "v": [
              "111.4",
              "114.3",
              "115.9",
              "117.7",
              "111.4",
              "114.3",
              "115.9",
              "117.7",
              "117.7"
            ]
          },
          {
            "-id": "023",
            "v": [
              "110.9",
              "114.4",
              "116",
              "117.6",
              "110.9",
              "114.4",
              "116",
              "117.6",
              "117.6"
            ]
          },
          {
            "-id": "024",
            "v": [
              "111.5",
              "114.3",
              "116.1",
              "118",
              "111.5",
              "114.3",
              "116.1",
              "118",
              "118"
            ]
          },
          {
            "-id": "025",
            "v": [
              "111.2",
              "114.5",
              "115.7",
              "118.1",
              "111.2",
              "114.5",
              "115.7",
              "118.1",
              "118.1"
            ]
          },
          {
            "-id": "026",
            "v": [
              "113.8",
              "115.4",
              "116.4",
              "119.1",
              "113.8",
              "115.4",
              "116.4",
              "119.1",
              "119.1"
            ]
          },
          {
            "-id": "027",
            "v": [
              "114.6",
              "114.6",
              "115.8",
              "118.2",
              "114.6",
              "114.6",
              "115.8",
              "118.2",
              "118.2"
            ]
          },
          {
            "-id": "028",
            "v": [
              "111.4",
              "114.3",
              "115.9",
              "117.7",
              "111.4",
              "114.3",
              "115.9",
              "117.7",
              "117.7"
            ]
          },
          {
            "-id": "029",
            "v": [
              "110.9",
              "114.4",
              "116",
              "117.6",
              "110.9",
              "114.4",
              "116",
              "117.6",
              "117.6"
            ]
          },
          {
            "-id": "030",
            "v": [
              "111.5",
              "114.3",
              "116.1",
              "118",
              "111.5",
              "114.3",
              "116.1",
              "118",
              "118"
            ]
          },
          {
            "-id": "031",
            "v": [
              "110.9",
              "114.4",
              "116",
              "117.6",
              "110.9",
              "114.4",
              "116",
              "117.6",
              "117.6"
            ]
          },
          {
            "-id": "032",
            "v": [
              "111.5",
              "114.3",
              "116.1",
              "118",
              "111.5",
              "114.3",
              "116.1",
              "118",
              "118"
            ]
          },
          {
            "-id": "033",
            "v": [
              "111.2",
              "114.5",
              "115.7",
              "118.1",
              "111.2",
              "114.5",
              "115.7",
              "118.1",
              "118.1"
            ]
          },
          {
            "-id": "034",
            "v": [
              "113.8",
              "115.4",
              "116.4",
              "119.1",
              "113.8",
              "115.4",
              "116.4",
              "119.1",
              "119.1"
            ]
          },
          {
            "-id": "035",
            "v": [
              "114.6",
              "114.6",
              "115.8",
              "118.2",
              "114.6",
              "114.6",
              "115.8",
              "118.2",
              "118.2"
            ]
          },
          {
            "-id": "036",
            "v": [
              "111.4",
              "114.3",
              "115.9",
              "117.7",
              "111.4",
              "114.3",
              "115.9",
              "117.7",
              "117.7"
            ]
          },
          {
            "-id": "037",
            "v": [
              "110.9",
              "114.4",
              "116",
              "117.6",
              "110.9",
              "114.4",
              "116",
              "117.6",
              "117.6"
            ]
          },
          {
            "-id": "038",
            "v": [
              "111.5",
              "114.3",
              "116.1",
              "118",
              "111.5",
              "114.3",
              "116.1",
              "118",
              "118"
            ]
          },
          {
            "-id": "039",
            "v": [
              "111.2",
              "114.5",
              "115.7",
              "118.1",
              "111.2",
              "114.5",
              "115.7",
              "118.1",
              "118.1"
            ]
          },
          {
            "-id": "040",
            "v": [
              "113.8",
              "115.4",
              "116.4",
              "119.1",
              "113.8",
              "115.4",
              "116.4",
              "119.1",
              "119.1"
            ]
          },
          {
            "-id": "041",
            "v": [
              "114.6",
              "114.6",
              "115.8",
              "118.2",
              "114.6",
              "114.6",
              "115.8",
              "118.2",
              "118.2"
            ]
          },
          {
            "-id": "042",
            "v": [
              "111.4",
              "114.3",
              "115.9",
              "117.7",
              "111.4",
              "114.3",
              "115.9",
              "117.7",
              "117.7"
            ]
          },
          {
            "-id": "043",
            "v": [
              "110.9",
              "114.4",
              "116",
              "117.6",
              "110.9",
              "114.4",
              "116",
              "117.6",
              "117.6"
            ]
          },
          {
            "-id": "044",
            "v": [
              "111.5",
              "114.3",
              "116.1",
              "118",
              "111.5",
              "114.3",
              "116.1",
              "118",
              "118"
            ]
          },
          {
            "-id": "045",
            "v": [
              "111.2",
              "114.5",
              "115.7",
              "118.1",
              "111.2",
              "114.5",
              "115.7",
              "118.1",
              "118.1"
            ]
          },
          {
            "-id": "046",
            "v": [
              "113.8",
              "115.4",
              "116.4",
              "119.1",
              "113.8",
              "115.4",
              "116.4",
              "119.1",
              "119.1"
            ]
          },
          {
            "-id": "047",
            "v": [
              "114.6",
              "114.6",
              "115.8",
              "118.2",
              "114.6",
              "114.6",
              "115.8",
              "118.2",
              "118.2"
            ]
          },
          {
            "-id": "048",
            "v": [
              "111.4",
              "114.3",
              "115.9",
              "117.7",
              "111.4",
              "114.3",
              "115.9",
              "117.7",
              "117.7"
            ]
          },
          {
            "-id": "049",
            "v": [
              "110.9",
              "114.4",
              "116",
              "117.6",
              "110.9",
              "114.4",
              "116",
              "117.6",
              "117.6"
            ]
          },
          {
            "-id": "050",
            "v": [
              "111.5",
              "114.3",
              "116.1",
              "118",
              "111.5",
              "114.3",
              "116.1",
              "118",
              "118"
            ]
          },
          {
            "-id": "051",
            "v": [
              "110.9",
              "114.4",
              "116",
              "117.6",
              "110.9",
              "114.4",
              "116",
              "117.6",
              "117.6"
            ]
          }
        ]
      }
    }
  }
}';

$data = json_decode($source);

$mapping = array(
    "av" => "ahalskiy",
    "ash" => "ashhabad",
    "bv" => "balkanskiy",
    "lv" => "lebapskiy",
    "dv" => "dashoguzskiy",
    "mv" => "mariyskiy",
);

$result = new stdClass();

$result->name = $data->indicator->{"-id"};
$result->title = $data->indicator->{"-name"};
$result->periods = array();

foreach ($data->indicator->velaiatdata->values->region as $region) {
    for ($i = 0; $i < count($region->v); $i++) {
        if (!isset($result->periods[$i])) {
            $result->periods[$i] = new stdClass();
            $result->periods[$i]->name = "period-{$i}";
            $result->periods[$i]->title = $data->indicator->dates->date[$i];
            $result->periods[$i]->values = array();
        }
        $tmp = new stdClass();
        $tmp->object = $mapping[$region->{"-id"}];
        $tmp->value = $region->v[$i];
        
        $result->periods[$i]->values[] = $tmp;
    }
}

echo json_encode_($result);

function json_encode_($string) {

  $arrayUtf = array('\u0410', '\u0430', '\u0411', '\u0431', '\u0412', '\u0432', '\u0413', '\u0433', '\u0414', '\u0434', '\u0415', '\u0435', '\u0401', '\u0451', '\u0416', '\u0436', '\u0417', '\u0437', '\u0418', '\u0438', '\u0419', '\u0439', '\u041a', '\u043a', '\u041b', '\u043b', '\u041c', '\u043c', '\u041d', '\u043d', '\u041e', '\u043e', '\u041f', '\u043f', '\u0420', '\u0440', '\u0421', '\u0441', '\u0422', '\u0442', '\u0423', '\u0443', '\u0424', '\u0444', '\u0425', '\u0445', '\u0426', '\u0446', '\u0427', '\u0447', '\u0428', '\u0448', '\u0429', '\u0449', '\u042a', '\u044a', '\u042b', '\u044b', '\u042c', '\u044c', '\u042d', '\u044d', '\u042e', '\u044e', '\u042f', '\u044f');

  $arrayCyr = array('А', 'а', 'Б', 'б', 'В', 'в', 'Г', 'г', 'Д', 'д', 'Е', 'е', 'Ё', 'ё', 'Ж', 'ж', 'З', 'з', 'И', 'и', 'Й', 'й', 'К', 'к', 'Л', 'л', 'М', 'м', 'Н', 'н', 'О', 'о', 'П', 'п', 'Р', 'р', 'С', 'с', 'Т', 'т', 'У', 'у', 'Ф', 'ф', 'Х', 'х', 'Ц', 'ц', 'Ч', 'ч', 'Ш', 'ш',  'Щ', 'щ', 'Ъ', 'ъ', 'Ы', 'ы', 'Ь', 'ь', 'Э', 'э', 'Ю', 'ю', 'Я', 'я');

  return str_replace($arrayUtf,$arrayCyr,json_encode($string));
}